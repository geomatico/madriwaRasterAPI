from starlette.testclient import TestClient

from madriwaraster.main import app

client = TestClient(app)


def test_heat_inland_view():
    data = {
        "side_square": 500,
        "point": {
            "type": "Point",
            "coordinates": {"coordinates": [-3.7060583, 40.4169019]},
        },
    }
    response = client.post("/api/v1/isladecalor/lts", json=data)
    assert response.status_code == 201
    assert response.json() == {
        "values": {
            "max": 31.07,
            "mean": 30.24,
            "min": 29.29,
            "point": {
                "lts": 30.81,
                "point": {
                    "type": "Point",
                    "coordinates": {"coordinates": [-3.7060583, 40.4169019]},
                },
            },
        },
        "image": "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",
    }


def test_point_not_cover_raster():
    data = {
        "side_square": 500,
        "point": {"type": "Point", "coordinates": {"coordinates": [0, 0]}},
    }
    response = client.post("/api/v1/isladecalor/lts", json=data)
    assert response.status_code == 404


def test_422_validation_error():
    data = {
        "side_square": 7000,
        "point": {
            "type": "Point",
            "coordinates": {"coordinates": [-3.7060583, 40.4169019]},
        },
    }

    print(data)
